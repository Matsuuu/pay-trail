<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <meta charset="utf-8" />
        <style>
            body {
                background: #cacaca;
            }

            .products {
                display: flex;
                flex-direction: column;
            }

            pay-trail {
                cursor: pointer;
            }
        </style>
    </head>
    <body>
        <pay-trail
            MERCHANT_ID="13466"
            URL_SUCCESS="http://www.example.com/success"
            URL_CANCEL="http://www.example.com/cancel"
            PARAMS_IN="MERCHANT_ID,URL_SUCCESS,URL_CANCEL,ORDER_NUMBER,PARAMS_IN,PARAMS_OUT,PAYER_PERSON_PHONE,PAYER_PERSON_EMAIL,PAYER_PERSON_FIRSTNAME,PAYER_PERSON_LASTNAME,PAYER_COMPANY_NAME,PAYER_PERSON_ADDR_STREET,PAYER_PERSON_ADDR_POSTAL_CODE,PAYER_PERSON_ADDR_TOWN,PAYER_PERSON_ADDR_COUNTRY,AMOUNT,PAYMENT_METHODS"
            PARAMS_OUT="ORDER_NUMBER,PAYMENT_ID,AMOUNT,CURRENCY,PAYMENT_METHOD,TIMESTAMP,STATUS"
            PAYER_PERSON_PHONE="01234567890"
            PAYER_PERSON_EMAIL="john.doe@example.com"
            PAYER_PERSON_FIRSTNAME="John"
            PAYER_PERSON_LASTNAME="Doe"
            PAYER_COMPANY_NAME="Test Company"
            PAYER_PERSON_ADDR_STREET="Test Street 1"
            PAYER_PERSON_ADDR_POSTAL_CODE="608009"
            PAYER_PERSON_ADDR_TOWN="Test Town"
            PAYER_PERSON_ADDR_COUNTRY="AA"
            PAYMENT_METHODS="52"
        >
            <img src="./sp.png" />
        </pay-trail>

        <button id="add-product" onclick="addProduct()">Add product</button>
        <button id="remove-product" onclick="removeProduct()">Remove product</button>

        <div class="products"></div>

        <script src="../../../Paytrail.js" type="module"></script>

        <script>
            const product = {
                item_id: 0,
                item_title: 'Product name',
                item_unit_price: '29.99',
                item_vat_percent: '24.00',
            };
            const paytrailField = document.querySelector('pay-trail');
            const productsField = document.querySelector('.products');

            const addProduct = () => {
                const prods = paytrailField.getProducts();
                const productCopy = { ...product };

                productCopy.item_title = 'Product name ' + prods.length;
                productCopy.item_id = prods.length;
                paytrailField.addProducts(productCopy);
                paytrailField.calculateAuthCodeString();

                const productRow = document.createElement('p');
                productRow.innerText = 'Product ' + prods.length;
                productsField.appendChild(productRow);
            };

            const removeProduct = () => {
                const prods = Array.from(productsField.querySelectorAll('p'));

                paytrailField.removeProductAtIndex(prods.length - 1);
                prods[prods.length - 1].remove();
                paytrailField.calculateAuthCodeString();
            };
        </script>
    </body>
</html>
